openapi: 3.0.0
servers:
  - url: https://<database_url>
    description: Access to your HIDDB databases
info:
  description: |
    Example usage:

    ```bash
    curl --location \
         --request GET "https://<database_url>/collection" \
         --header "Accept: application/json" \
    ```
  version: 0.3.0
  title: API documentation
  termsOfService: https:/hiddb.com/terms
  license:
    name: Propretary Licence
    url: https://hiddb.com/licence
tags:
  - name: Collection
    description: Operations on collections
  - name: Index
    description: Operations on indices
  - name: Document
    description: Operations on documents
paths:
  /collection:
    servers:
      - url: https://<database_url>
        description: General operations
    get:
      tags:
        - Collection
      description: Get information about collections
      summary: Get collections
      operationId: listCollections
      responses:
        "200":
          description: successful operation
          content:
            application/json:
              schema:
                type: object
                additionalProperties: false
                required:
                  - collections
                properties:
                  collections:
                    type: array
                    items:
                      type: object
                      additionalProperties: false
                      required:
                        - collection_name
                        - n_documents
                      properties:
                        collection_name:
                          type: string
                          minLength: 3
                          maxLength: 20
                          pattern: ^[a-z0-9_-]{3,20}$
                          example: xxxxxxxxxxxxxxxxxx
                        n_documents:
                          type: number
                          format: int64
                          minimum: 0
        default:
          description: error
          content:
            application/json:
              schema:
                type: object
                nullable: true
                additionalProperties: true
                required:
                  - error
                properties:
                  error:
                    type: string
    post:
      tags:
        - Collection
      description: Create new collection
      summary: Create collection
      operationId: createCollection
      requestBody:
        content:
          application/json:
            schema:
              description: Collection details
              type: object
              required:
                - collection_name
              additionalProperties: false
              properties:
                collection_name:
                  type: string
                  minLength: 3
                  maxLength: 20
                  pattern: ^[a-z0-9_-]{3,20}$
                  example: xxxxxxxxxxxxxxxxxx
      responses:
        "200":
          description: successful operation
          content:
            application/json:
              schema:
                type: object
                additionalProperties: false
                required:
                  - collection_name
                  - n_documents
                properties:
                  collection_name:
                    type: string
                    minLength: 3
                    maxLength: 20
                    pattern: ^[a-z0-9_-]{3,20}$
                    example: xxxxxxxxxxxxxxxxxx
                  n_documents:
                    type: number
                    format: int64
                    minimum: 0
        default:
          description: error
          content:
            application/json:
              schema:
                type: object
                nullable: true
                additionalProperties: true
                required:
                  - error
                properties:
                  error:
                    type: string
  "/collection/{collection_name}":
    servers:
      - url: https://<database_url>
        description: General operations
    get:
      tags:
        - Collection
      description: Get information about a specific collection
      summary: Get collection
      operationId: getCollection
      parameters:
        - name: collection_name
          in: path
          required: true
          schema:
            type: string
            minLength: 3
            maxLength: 20
            pattern: ^[a-z0-9_-]{3,20}$
      responses:
        "200":
          description: successful operation
          content:
            application/json:
              schema:
                type: object
                additionalProperties: false
                required:
                  - collection_name
                  - n_documents
                properties:
                  collection_name:
                    type: string
                    minLength: 3
                    maxLength: 20
                    pattern: ^[a-z0-9_-]{3,20}$
                    example: xxxxxxxxxxxxxxxxxx
                  n_documents:
                    type: number
                    format: int64
                    minimum: 0
        default:
          description: error
          content:
            application/json:
              schema:
                type: object
                nullable: true
                additionalProperties: true
                required:
                  - error
                properties:
                  error:
                    type: string
    delete:
      tags:
        - Collection
      description: Delete a specific collection
      summary: Delete collection
      operationId: deleteCollection
      parameters:
        - name: collection_name
          in: path
          required: true
          schema:
            type: string
            minLength: 3
            maxLength: 20
            pattern: ^[a-z0-9_-]{3,20}$
      responses:
        "200":
          description: successful operation
          content:
            application/json:
              schema:
                type: object
                additionalProperties: false
                required:
                  - collection_name
                  - n_documents
                properties:
                  collection_name:
                    type: string
                    minLength: 3
                    maxLength: 20
                    pattern: ^[a-z0-9_-]{3,20}$
                    example: xxxxxxxxxxxxxxxxxx
                  n_documents:
                    type: number
                    format: int64
                    minimum: 0
        default:
          description: error
          content:
            application/json:
              schema:
                type: object
                nullable: true
                additionalProperties: true
                required:
                  - error
                properties:
                  error:
                    type: string
  "/collection/{collection_name}/index":
    servers:
      - url: https://<database_url>
        description: General operations
    parameters:
      - name: collection_name
        in: path
        description: The ID of the collection
        example: xxxxxxxxxxxxxxxxxx
        required: true
        schema:
          type: string
          minLength: 3
          maxLength: 20
          pattern: ^[a-z0-9_-]{3,20}$
    get:
      tags:
        - Index
      description: Get information about an existing indices
      summary: Get indices
      operationId: listIndices
      responses:
        "200":
          description: successful operation
          content:
            application/json:
              schema:
                type: object
                additionalProperties: false
                required:
                  - indices
                properties:
                  indices:
                    type: array
                    items:
                      type: object
                      additionalProperties: false
                      required:
                        - collection_name
                        - field_name
                        - n_documents
                        - distance_metric
                        - dimension
                      properties:
                        collection_name:
                          type: string
                          minLength: 3
                          maxLength: 20
                          pattern: ^[a-z0-9_-]{3,20}$
                          example: xxxxxxxxxxxxxxxxxx
                        field_name:
                          type: string
                          minLength: 3
                          maxLength: 20
                          pattern: ^[a-z0-9_-]{3,20}$
                          example: xxxxxxxxxxxxxxxxxx
                        n_documents:
                          type: integer
                          format: int64
                        distance_metric:
                          type: string
                          enum:
                            - euclidean
                        dimension:
                          type: integer
                          format: int64
        default:
          description: error
          content:
            application/json:
              schema:
                type: object
                nullable: true
                additionalProperties: true
                required:
                  - error
                properties:
                  error:
                    type: string
    post:
      tags:
        - Index
      description: Create new index in the specified collection
      summary: Create index
      operationId: createIndex
      requestBody:
        content:
          application/json:
            schema:
              type: object
              required:
                - field_name
                - dimension
              additionalProperties: false
              properties:
                field_name:
                  type: string
                  minLength: 3
                  maxLength: 20
                  pattern: ^[a-z0-9_-]{3,20}$
                  example: xxxxxxxxxxxxxxxxxx
                dimension:
                  type: integer
                  format: int64
      responses:
        "200":
          description: successful operation
          content:
            application/json:
              schema:
                type: object
                additionalProperties: false
                required:
                  - collection_name
                  - field_name
                  - n_documents
                  - distance_metric
                  - dimension
                properties:
                  collection_name:
                    type: string
                    minLength: 3
                    maxLength: 20
                    pattern: ^[a-z0-9_-]{3,20}$
                    example: xxxxxxxxxxxxxxxxxx
                  field_name:
                    type: string
                    minLength: 3
                    maxLength: 20
                    pattern: ^[a-z0-9_-]{3,20}$
                    example: xxxxxxxxxxxxxxxxxx
                  n_documents:
                    type: integer
                    format: int64
                  distance_metric:
                    type: string
                    enum:
                      - euclidean
                  dimension:
                    type: integer
                    format: int64
        default:
          description: error
          content:
            application/json:
              schema:
                type: object
                nullable: true
                additionalProperties: true
                required:
                  - error
                properties:
                  error:
                    type: string
  "/collection/{collection_name}/index/{field_name}":
    servers:
      - url: https://<database_url>
        description: General operations
    parameters:
      - name: collection_name
        in: path
        description: The ID of the collection
        example: xxxxxxxxxxxxxxxxxx
        required: true
        schema:
          type: string
          minLength: 3
          maxLength: 20
          pattern: ^[a-z0-9_-]{3,20}$
      - name: field_name
        in: path
        description: The ID of the index
        example: xxxxxxxxxxxxxxxxxx
        required: true
        schema:
          type: string
          minLength: 3
          maxLength: 20
          pattern: ^[a-z0-9_-]{3,20}$
    get:
      tags:
        - Index
      description: Get information about specific index
      summary: Get index
      operationId: getIndex
      responses:
        "200":
          description: successful operation
          content:
            application/json:
              schema:
                type: object
                additionalProperties: false
                required:
                  - collection_name
                  - field_name
                  - n_documents
                  - distance_metric
                  - dimension
                properties:
                  collection_name:
                    type: string
                    minLength: 3
                    maxLength: 20
                    pattern: ^[a-z0-9_-]{3,20}$
                    example: xxxxxxxxxxxxxxxxxx
                  field_name:
                    type: string
                    minLength: 3
                    maxLength: 20
                    pattern: ^[a-z0-9_-]{3,20}$
                    example: xxxxxxxxxxxxxxxxxx
                  n_documents:
                    type: integer
                    format: int64
                  distance_metric:
                    type: string
                    enum:
                      - euclidean
                  dimension:
                    type: integer
                    format: int64
        default:
          description: error
          content:
            application/json:
              schema:
                type: object
                nullable: true
                additionalProperties: true
                required:
                  - error
                properties:
                  error:
                    type: string
    delete:
      tags:
        - Index
      description: Delete index
      summary: Delete index
      operationId: deleteIndex
      responses:
        "200":
          description: successful operation
          content:
            application/json:
              schema:
                type: object
                additionalProperties: false
                required:
                  - collection_name
                  - field_name
                  - n_documents
                  - distance_metric
                  - dimension
                properties:
                  collection_name:
                    type: string
                    minLength: 3
                    maxLength: 20
                    pattern: ^[a-z0-9_-]{3,20}$
                    example: xxxxxxxxxxxxxxxxxx
                  field_name:
                    type: string
                    minLength: 3
                    maxLength: 20
                    pattern: ^[a-z0-9_-]{3,20}$
                    example: xxxxxxxxxxxxxxxxxx
                  n_documents:
                    type: integer
                    format: int64
                  distance_metric:
                    type: string
                    enum:
                      - euclidean
                  dimension:
                    type: integer
                    format: int64
        default:
          description: error
          content:
            application/json:
              schema:
                type: object
                nullable: true
                additionalProperties: true
                required:
                  - error
                properties:
                  error:
                    type: string
  "/collection/{collection_name}/document":
    servers:
      - url: https://<database_url>
        description: General operations
    parameters:
      - name: collection_name
        in: path
        description: The ID of the collection
        example: xxxxxxxxxxxxxxxxxx
        required: true
        schema:
          type: string
          minLength: 3
          maxLength: 20
          pattern: ^[a-z0-9_-]{3,20}$
    post:
      tags:
        - Document
      description: Insert document. The field "field_name" can be indexed by an index with the same name
      summary: Insert document
      operationId: insertDocuments
      requestBody:
        content:
          application/json:
            schema:
              required:
                - documents
              additionalProperties: false
              properties:
                documents:
                  type: array
                  items:
                    type: object
                    required:
                      - id
                    additionalProperties: true
                    properties:
                      id:
                        type: string
                        minLength: 3
                        maxLength: 50
                      field:
                        type: array
                        items:
                          type: number
                          format: double
                        example:
                          - 1
                          - 2
                          - 3
          application/octet-stream:
            schema:
              type: string
              format: binary
      responses:
        "200":
          description: Insertion successful
        default:
          description: error
          content:
            application/json:
              schema:
                type: object
                nullable: true
                additionalProperties: true
                required:
                  - error
                properties:
                  error:
                    type: string
  "/collection/{collection_name}/document/search":
    servers:
      - url: https://<database_url>
        description: General operations
    parameters:
      - name: collection_name
        in: path
        description: The ID of the collection
        example: xxxxxxxxxxxxxxxxxx
        required: true
        schema:
          type: string
          minLength: 3
          maxLength: 20
          pattern: ^[a-z0-9_-]{3,20}$
    post:
      tags:
        - Document
      description: "Search for nearest vectors to specified vector. Instead of specifying `vector: <array>` you can search for similar documents directly by setting `id: <document_id>` instead"
      summary: ANN-search
      operationId: getAnn
      requestBody:
        content:
          application/json:
            schema:
              type: object
              required:
                - max_neighbors
                - field_name
              additionalProperties: false
              properties:
                ids:
                  type: array
                  items:
                    type: string
                  example:
                    - document1
                    - document2
                    - document3
                  description: Get documents close to the specified document. Provide either `ids` or `vectors`
                vectors:
                  type: array
                  items:
                    type: array
                    items:
                      type: number
                  example:
                    - - 1
                      - 2
                      - 3
                  description: Get documents close to the vector. The length of the vector must be equal to the dimension specified in the index
                max_neighbors:
                  type: number
                  default: 20
                  minimum: 1
                  description: Maximal number of neighbors to include in response
                field_name:
                  type: string
                  minLength: 3
                  maxLength: 20
                  pattern: ^[a-z0-9_-]{3,20}$
                  description: This parameter specifies the index to perform the query in
                  example: xxxxxxxxxxxxxxxxxx
          application/octet-stream:
            schema:
              type: string
              format: binary
      responses:
        "200":
          description: Insertion successful
          content:
            application/json:
              schema:
                type: array
                items:
                  type: object
                  additionalProperties: false
                  required:
                    - data
                  properties:
                    data:
                      type: array
                      items:
                        type: array
                        items:
                          type: string
        default:
          description: error
          content:
            application/json:
              schema:
                type: object
                nullable: true
                additionalProperties: true
                required:
                  - error
                properties:
                  error:
                    type: string
  "/collection/{collection_name}/document/{document_id}":
    servers:
      - url: https://<database_url>
        description: General operations
    parameters:
      - name: collection_name
        in: path
        description: The ID of the collection
        example: xxxxxxxxxxxxxxxxxx
        required: true
        schema:
          type: string
          minLength: 3
          maxLength: 20
          pattern: ^[a-z0-9_-]{3,20}$
      - name: document_id
        in: path
        description: The ID of the index
        example: xxxxxxxxxxxxxxxxxx
        required: true
        schema:
          type: string
          minLength: 3
          maxLength: 20
          pattern: ^[a-z0-9_-]{3,20}$
    get:
      tags:
        - Document
      description: Get document by ID
      summary: Get document by ID
      operationId: getDocument
      responses:
        "200":
          description: Insertion successful
          content:
            application/json:
              schema:
                type: object
                additionalProperties: true
                required:
                  - id
                properties:
                  id:
                    type: string
                    minLength: 3
                    maxLength: 50
                  field:
                    type: array
                    items:
                      type: number
                      format: double
                    example:
                      - 1
                      - 2
                      - 3
        default:
          description: error
          content:
            application/json:
              schema:
                type: object
                nullable: true
                additionalProperties: true
                required:
                  - error
                properties:
                  error:
                    type: string
    delete:
      tags:
        - Document
      description: Remove document by ID. The document is deleted from the collection and the corresponding indices are updated.
      summary: Remove document by ID
      operationId: deleteDocument
      responses:
        "200":
          description: Insertion successful
          content:
            application/json:
              schema:
                type: object
                additionalProperties: true
                required:
                  - id
                properties:
                  id:
                    type: string
                    minLength: 3
                    maxLength: 50
                  field:
                    type: array
                    items:
                      type: number
                      format: double
                    example:
                      - 1
                      - 2
                      - 3
        default:
          description: error
          content:
            application/json:
              schema:
                type: object
                nullable: true
                additionalProperties: true
                required:
                  - error
                properties:
                  error:
                    type: string
